---
title: "Malware Diary: DigMine Part2 - Dynamic Analysis ‡∏â‡∏ö‡∏±‡∏ö‡∏Ñ‡∏ô‡∏Ç‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡∏¢‡∏à"
date: 2019-06-03T02:00:53+07:00
draft: false
categories: ["Malware Analysis : DigMine"]
featured_image: "/images/malware-diary2/1.jpg"
featured_image_caption: "‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏≤‡∏Å‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏á‡πÅ‡∏ï‡πà Malware Sandbox ‡∏Å‡∏•‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡πÑ‡∏°‡πà‡∏û‡∏ö ‡∏ó‡∏≥‡πÑ‡∏á‡∏î‡∏µ‡∏ô‡πâ‡∏≤‡∏≤?"
---


‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà Part ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏ö‡∏ö Static Analysis ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏£‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å Source Code ‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡∏ñ‡πâ‡∏≤ Source Code ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏°‡∏µ‡∏Å‡∏≤‡∏£ Obfuscate ‡πÑ‡∏ß‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á‡∏à‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏Ñ‡∏ß‡∏£‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏ö‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏á ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ Source Code ‡∏°‡∏≤‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏≠‡∏≠‡∏Å‡∏≠‡∏¢‡∏π‡πà‡∏î‡∏µ -___- 

‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡πà‡∏≠‡∏°‡∏≤...‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏á‡∏ï‡πà‡∏≠‡∏≠‡πà‡∏∞ 
‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡πÄ‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ Dynamic Analysis ‡πÅ‡∏ï‡πà‡πÄ‡∏Ñ‡∏™‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏£‡∏≤‡∏Ç‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡∏¢‡∏à‡πÑ‡∏á ‡∏à‡∏∞‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ Ollydbg ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏ß‡∏Å Debugger ‡∏Å‡πá‡∏Ç‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡∏¢‡∏à(‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏°‡∏±‡πà‡∏¢‡πÄ‡∏õ‡∏ô‡∏ô‡∏ô‡∏ô) ‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ Source Code  ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ

‡∏à‡∏≥‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å Part ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏≤‡∏Å Source Code ‡πÄ‡∏£‡∏≤‡∏£‡∏π‡πâ‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á?
‡πÄ‡∏£‡∏≤‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏°‡∏µ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™ 

```AutoIt
Func gmfnzmi($gzhkalbyyq)
	$omipkddl = ""
	For $dlcqoqsup = $rgnzkvwianz To kfwjwweupfy($gzhkalbyyq)
		$swfrwp = divznduthlwg($gzhkalbyyq, $dlcqoqsup, furhpb())
		$qkkocudrwel = ejncdqtyn($usurpagyyn, $swfrwp, iewdtkkvw())
		$omipkddl &= divznduthlwg($dxbvhjewu, $qkkocudrwel, $mpbuyk)
	Next
	Return $omipkddl
EndFunc
```

‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏≠‡∏≤ Source Code ‡πÄ‡∏ô‡∏µ‡πâ‡∏¢ ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏á?
‡∏ñ‡πâ‡∏≤‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ô‡∏Ç‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡∏¢‡∏à ‡πÜ ‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡πÉ‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏≤‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÅ‡∏Å‡πâ‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏™‡∏¥...

```AutoIt
Func gmfnzmi($gzhkalbyyq)
	$omipkddl = ""
	ConsoleWrite("Before: " & $gzhkalbyyq & @CRLF)
	For $dlcqoqsup = $rgnzkvwianz To kfwjwweupfy($gzhkalbyyq)
		$swfrwp = divznduthlwg($gzhkalbyyq, $dlcqoqsup, furhpb())
		$qkkocudrwel = ejncdqtyn($usurpagyyn, $swfrwp, iewdtkkvw())
		$omipkddl &= divznduthlwg($dxbvhjewu, $qkkocudrwel, $mpbuyk)
	Next
	ConsoleWrite("After: " & $omipkddl & @CRLF)
	Return $omipkddl
EndFunc
```

‡∏à‡∏≥ VM ? ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤ Setting ‡πÑ‡∏ß‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏≤‡∏Å Part ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏î‡πâ‡∏õ‡πà‡∏∞? 
‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÑ‡∏õ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏≠‡∏°‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏•‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏†‡∏≤‡∏©‡∏≤ AutoIt ‡∏°‡∏≤‡∏•‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ô‡πÇ‡∏Ñ‡πä‡∏î‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏õ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô

‡πÅ‡∏ï‡πà! ‡∏≠‡∏¢‡πà‡∏≤‡∏û‡∏∂‡πà‡∏á‡∏£‡∏±‡∏ô‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö ‡∏•‡∏á Google Chrome ‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏°‡∏µ Mechanism ‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö Google Chrome ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏î‡πâ‡∏ß‡∏¢(‡∏ñ‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏£‡∏π‡πâ‡πÑ‡∏î‡πâ‡πÑ‡∏á ‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡∏á‡∏≠‡πà‡∏∞ ‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏±‡∏ô‡∏Å‡πá‡∏´‡∏≤‡∏≠‡∏∞‡πÑ‡∏£‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ ‡∏°‡∏≤‡πÄ‡∏à‡∏≠‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡∏ß‡πà‡∏≤ DigMine ‡∏°‡∏±‡∏ô‡∏°‡∏µ Mechanism ‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ö Google Chrome ‡∏î‡πâ‡∏ß‡∏¢)

‡πÅ‡∏•‡πâ‡∏ß‡∏ñ‡πâ‡∏≤‡∏•‡∏á Google Chrome ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏±‡∏ô‡πÄ‡∏•‡∏¢‡∏°‡∏±‡πâ‡∏¢?
‡∏Å‡πá‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡∏î‡∏µ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏£‡∏π‡πâ‡πÅ‡∏Ñ‡πà‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ô‡∏≥‡∏ß‡πà‡∏≤‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™ ‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á ‡∏≠‡∏≤‡∏à‡∏û‡∏•‡∏≤‡∏î‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô 
‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô Network ‡πÄ‡∏£‡∏≤‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏ô‡πà‡∏≤‡πÄ‡∏´‡πá‡∏ô Flow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Network ‡∏à‡∏≤‡∏Å Source Code ‡∏´‡∏£‡∏≠‡∏Å‡∏ñ‡∏π‡∏Å‡∏°‡∏∞?
‡∏â‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ **[Wireshark](https://www.wireshark.org/)** ‡∏Ñ‡∏£‡∏±‡∏ö

‡∏ñ‡πâ‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÅ‡∏Ñ‡πà Wireshark ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö Packet ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏£‡∏≤ ‡πÅ‡∏ï‡πà‡πÅ‡∏Ñ‡πà‡∏ô‡∏±‡πâ‡∏ô‡∏ú‡∏°‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠‡∏ô‡∏∞ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ñ‡πâ‡∏≤‡∏°‡∏±‡∏ô‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡πÄ‡∏ä‡πà‡∏ô Registry ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á Wireshark ‡πÄ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏î‡πâ‡∏ß‡∏¢ ‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ **[Process Monitor](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon)**  ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏∑‡∏≠ ProcMon (‡∏à‡∏≤‡∏Å‡∏•‡∏π‡∏Å‡∏û‡∏µ‡πà Microsoft ‡πÄ‡∏≠‡∏á‡πÄ‡∏ö‡∏¢)

‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏à‡πâ‡∏≤ ProcMon  ‡πÄ‡∏ô‡∏µ‡πà‡∏¢ ‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏±‡∏ô‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢ ‡πÜ ‡∏Å‡∏±‡∏ö Wireshark ‡πÅ‡∏ï‡πà‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏ô‡∏î‡∏±‡∏Å‡∏à‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô Event ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô Windows  
‡∏û‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏™‡∏£‡πá‡∏à‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏Å‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏Å‡∏î Snapshot ‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏≠‡∏¢‡∏≤‡∏Å‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ó‡∏≥‡πÉ‡∏´‡∏°‡πà

‡πÄ‡∏õ‡∏¥‡∏î Wireshark ‡∏Å‡∏±‡∏ö ProcMon ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤ ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡πá‡∏Å‡∏î‡πÅ‡∏Ñ‡∏õ‡πÄ‡∏ä‡∏≠‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö...

![‡∏ó‡∏≥‡πÑ‡∏°‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏≠‡πà‡∏∞...](/images/malware-diary2/3.jpg)

 ‡∏≠‡πâ‡∏≤‡∏ß ‡∏Ñ‡∏ô‡∏•‡∏∞‡πÅ‡∏Ñ‡∏õ‡∏´‡∏£‡∏≠ ‡πÄ‡∏Ñ ‡πÜ‡πÜ‡πÜ‡πÜ
‡∏Å‡∏î Capture ‡∏Ç‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡πá‡∏£‡∏±‡∏ô AutoIt ‡πÄ‡∏•‡∏¢‡∏à‡πâ‡∏≤‡∏°... (‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏¥‡πâ‡∏°[‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ]([https://github.com/jusmistic/Malware-Analysis-DigMine/blob/master/Source%20Code/malware_output.txt](https://github.com/jusmistic/Malware-Analysis-DigMine/blob/master/Source Code/malware_output.txt))‡∏à‡πâ‡∏≤)

![‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ó‡πå‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå](/images/malware-diary2/69.png)

‡πÅ‡∏ï‡πà‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡∏ß‡πà‡∏≤‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡∏∑‡∏≠‚Ä¶ **‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤ Control Flow ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡πÄ‡∏•‡∏¢‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏ö‡πâ‡∏≤‡∏á**

  

‡πÅ‡∏ï‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ú‡∏°‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏∏‡∏î‡∏π Flow ‡∏ô‡∏µ‡∏±‡∏¢‡∏Ñ‡∏∑‡∏≠ Flow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏°‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Infect ‡∏≠‡πà‡∏∞ ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà ‡πÄ‡∏´‡πâ‡∏¢ ‡πÄ‡∏Å‡∏∑‡∏≠‡∏ö‡∏•‡∏∑‡∏°‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏°‡∏µ‡πÅ‡∏Ñ‡πà String ‡∏ä‡∏∏‡∏î‡∏ô‡∏µ‡πâ‡∏ô‡∏µ‡πà‡∏´‡∏ß‡πà‡∏≤ ‡πÄ‡∏£‡∏≤‡∏¢‡∏±‡∏á‡∏°‡∏µ Pcap ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏Å‡∏î‡πÅ‡∏Ñ‡∏õ‡πÄ‡∏ä‡∏≠(‡∏õ‡∏£‡∏≤‡∏á)‡∏ö‡∏ô Wireshark ‡∏Å‡∏±‡∏ö Log ‡∏Ç‡∏≠‡∏á ProcMon ‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏µ‡πà‡∏´‡∏ß‡πà‡∏≤.. ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏à‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°

  

‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡∏°‡∏ó‡∏≥‡∏Ñ‡∏∑‡∏≠ ‡∏ú‡∏°‡∏à‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡∏π‡∏à‡∏≤‡∏Å String ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡∏ú‡∏°‡∏à‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏î‡∏π‡∏ó‡∏µ‡πà pcap ‡∏Å‡∏±‡∏ö Log ‡∏ô‡∏∞ ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏•‡πà ‡πÜ ‡∏≠‡πà‡∏≤‡∏ô String ‡πÑ‡∏õ‡πÄ‡∏à‡∏≠‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 47

![www.google.com ü§î](/images/malware-diary2/4.jpg)

 ‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡πÅ‡∏Æ‡∏∞ ‡∏á‡∏±‡πâ‡∏ô‡∏•‡∏≠‡∏á‡πÑ‡∏õ‡∏î‡∏π‡πÉ‡∏ô Wireshark ‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤..

  ![Paket ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ç‡∏≠ www.google.com ‡∏à‡∏≤‡∏Å DNS Server](/images/malware-diary2/5.jpg)

‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å DNS ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Google ‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡πÅ‡∏Æ‡∏∞ ‡πÄ‡∏•‡∏¢‡πÑ‡∏•‡πà‡∏î‡∏π‡∏ï‡πà‡∏≠‡∏Ñ‡∏∑‡∏≠‡∏°‡∏±‡∏ô Ping ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Google ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏∑‡∏≠..‡∏ó‡∏≥‡πÑ‡∏°? ‡πÄ‡∏•‡∏¢‡∏°‡∏≤‡∏ô‡∏±‡πà‡∏á‡∏Ñ‡∏¥‡∏î‡∏ô‡∏≠‡∏ô‡∏Ñ‡∏¥‡∏î ‡∏ú‡∏°‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏° ‡∏ñ‡πâ‡∏≤‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏°‡∏±‡∏ô‡∏Ñ‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏ã‡∏±‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡∏∂‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ (‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡∏Ñ‡∏≤‡∏î‡πÄ‡∏î‡∏≤‡πÄ‡∏≠‡∏≤‡∏à‡∏≤‡∏Å‡∏ö‡∏£‡∏¥‡∏ö‡∏ó‡∏ô‡∏∞ ‡∏¢‡∏±‡∏á‡πÑ‡∏á‡πÉ‡∏Ñ‡∏£‡∏ß‡πà‡∏≤‡∏á ‡πÜ ‡∏•‡∏≠‡∏á‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï‡∏ó‡∏µ ‡πÑ‡∏î‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏ö‡∏≠‡∏Å‡∏ú‡∏°‡∏î‡πâ‡∏ß‡∏¢ 5555)

 ‡πÇ‡∏≠‡πÄ‡∏Ñ ‡πÄ‡∏£‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏î‡∏π‡∏ó‡∏µ‡πà String ‡∏ï‡πà‡∏≠‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÄ‡∏à‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à

![‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô HTTP Request ‡πÄ‡∏ö‡∏¢!](/images/malware-diary2/6.png)

‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏î‡∏π‡∏ó‡∏µ‡πà Wireshark ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏°‡∏±‡∏ô‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å HTTP Request ‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏Ç‡∏≠‡∏ï‡∏±‡∏î‡∏°‡∏≤ Network 101 ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á DNS ‡∏Å‡πà‡∏≠‡∏ô

![‡πåNetwork 101](/images/malware-diary2/7.png)  

‡∏Ñ‡∏∑‡∏≠‡∏à‡∏∞‡πÄ‡∏•‡πà‡∏≤‡∏¢‡πà‡∏≠ ‡πÜ DNS ‡∏Ñ‡∏∑‡∏≠ Service ‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô  IP ‡∏ñ‡∏π‡∏Å‡∏°‡∏∞ ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô(‡∏™‡∏µ‡πÅ‡∏î‡∏á)‡∏°‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠ Query ‡πÑ‡∏õ‡∏Ç‡∏≠ fusu[.]icu ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ Type A ‡∏Ñ‡∏∑‡∏≠ Type A ‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡πÉ‡∏´‡πâ DNS Server ‡∏°‡∏±‡∏ô‡∏ï‡∏≠‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô IP ‡∏´‡∏ô‡πà‡∏≠‡∏¢(‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß) ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏≤ IP ‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏ï‡πà‡∏≠

  **‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏±‡πâ‡∏ô ‡πÜ ‡∏Å‡πá‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ô‡∏µ‡πâ ‡∏ñ‡πâ‡∏≤‡∏á‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏ñ‡∏≤‡∏°‡∏ú‡∏°‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ú‡∏°‡∏Å‡πá‡∏á‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô**

  ‡∏ñ‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢? ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡∏´‡∏≤ Flow ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏¢‡∏±‡∏á Host ‡∏ô‡∏µ‡πâ‡πÉ‡∏ô Wireshark ‡πÑ‡∏á ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏≠‡∏ô Filter ‡∏°‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ IP! ‡∏ã‡∏∂‡πà‡∏á‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ 104.27.136.252 ‡πÅ‡∏•‡∏∞ 104.27.137.252 ‡∏ô‡∏∞

  ![‡∏°‡∏±‡∏ô‡∏°‡∏µ HTTP Request ‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡∏î‡πâ‡∏ß‡∏¢‡πÇ‡∏ß‡πâ‡∏¢‡∏¢‡∏¢](/images/malware-diary2/8.png)

‚Äã    ‡πÄ‡∏≠‡∏≤‡∏ï‡∏£‡∏á ‡πÜ ‡∏õ‡πà‡∏∞ ‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏ú‡∏°‡πÄ‡∏´‡πá‡∏ô Packet ‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡πÇ‡∏Ñ‡∏ï‡∏£‡∏ß‡πâ‡∏≤‡∏ß‡πÄ‡∏•‡∏¢‡∏≠‡πà‡∏∞ ‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏´‡πá‡∏ô‡πÉ‡∏Ñ‡∏£‡πÉ‡∏ä‡πâ HEAD Method ‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ô‡∏±‡∏ö CTF ‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ‡∏≠‡∏µ‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏°‡∏±‡∏ô‡πÇ‡∏Ñ‡∏ï‡∏£ Creative ‡∏Ñ‡∏∑‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏ô‡∏µ‡πà‡∏¢ HEAD Method ‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡πÅ‡∏ï‡πà‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô HTTP Header ‡πÅ‡∏•‡πâ‡∏ß Server ‡∏Å‡πá‡∏ï‡∏≠‡∏ö‡∏°‡∏≤‡πÑ‡∏î‡πâ‡πÅ‡∏ï‡πà‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô Header ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô ‡∏ã‡∏∂‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏° Creative ‡∏°‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ô‡∏ó‡∏≥‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡πÄ‡∏Ñ‡πâ‡∏≤‡πÄ‡∏≠‡∏≤‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏±‡∏ô‡∏ó‡∏≥‡πÄ‡∏õ‡πá‡∏ô Custom Header ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡πÑ‡∏õ ‡πÅ‡∏•‡πâ‡∏ß Server ‡∏Å‡πá‡∏ï‡∏≠‡∏ö‡πÇ‡∏î‡∏¢‡πÅ‡∏õ‡∏∞‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô Custom Header ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô ‡πÄ‡∏≠‡πâ‡∏∞ ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏Å‡∏ï‡∏¥‡πÄ‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß 55555

‚Äã    ‡∏à‡∏≤‡∏Å Packet ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡πÄ‡∏£‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà Server ‡πÅ‡∏•‡πâ‡∏ß Server ‡∏Å‡πá Reply ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÇ‡∏î‡∏¢‡∏°‡∏µ Custom Header ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡∏°‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏∑‡∏≠ Unzip ‡∏Å‡∏±‡∏ö Zip ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏°‡∏µ Url ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡∏≠‡∏¢‡∏π‡πà

  ‡πÄ‡∏•‡∏¢‡∏°‡∏≤‡πÑ‡∏•‡πà‡∏î‡∏π Flow Packet ‡∏ï‡πà‡∏≠

![HTTP Request Method ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à](/images/malware-diary2/9)

‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà url ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ñ‡πà‡∏≤ unzip ‡πÅ‡∏•‡∏∞ zip ‡∏î‡πâ‡∏ß‡∏¢ ‡πÅ‡∏ï‡πà‚Ä¶‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡∏•‡πà‡∏∞

![‡∏™‡πà‡∏≠‡∏á Log ‡∏Ç‡∏≠‡∏á ProcMon ‡πÅ‡∏õ‡∏õ](/images/malware-diary2/10.jpg)

‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà %appdata%/ ‡∏ã‡∏∂‡πà‡∏á‡∏ñ‡πâ‡∏≤‡∏•‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏î‡∏π‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏à‡∏≠‡∏ó‡∏±‡πâ‡∏á 7za.exe ‡πÅ‡∏•‡∏∞ files.7z ‡πÅ‡∏ï‡πà‚Ä¶ ‡∏°‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏à‡∏≠‡πÅ‡∏Ñ‡πà‡∏ô‡∏±‡πâ‡∏ô‡∏≠‡πà‡∏∞‡∏î‡∏¥

![WTF ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏´‡∏ô‡∏ü‡∏∞‡∏∞](/images/malware-diary2/10-fix1.png)

‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡πÑ‡∏•‡πà‡∏î‡∏π Wireshark ‡∏Å‡πá‡πÑ‡∏°‡πà‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏Æ‡∏∞‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡πÑ‡∏õ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÑ‡∏ü‡∏•‡πå‡∏û‡∏ß‡∏Å‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡∏ï‡∏≠‡∏ô‡πÑ‡∏´‡∏ô ‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏≤‡πÉ‡∏ô String ‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏î‡∏π

> After: 7za.exe e files.7z -aoa -p(‡∏û‡∏≤‡∏™‡πÄ‡∏ß‡∏¥‡∏£‡πå‡∏î)

‡∏û‡∏≠‡πÄ‡∏´‡πá‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡∏û‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏•‡∏∞ ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏±‡∏ô‡πÉ‡∏à‡πÄ‡∏•‡∏¢‡∏•‡∏≠‡∏á‡πÑ‡∏õ‡∏´‡∏≤‡πÉ‡∏ô Google ‡∏ï‡πà‡∏≠‚Ä¶ ‡∏û‡∏ö‡∏ß‡πà‡∏≤ 7za.exe ‡∏Ñ‡∏∑‡∏≠‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° 7z ‡πÅ‡∏ö‡∏ö Standalone (‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡∏±‡∏î‡πÑ‡∏ß‡πâ‡πÉ‡∏ô Binary ‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß) ‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå files.7z ‡πÇ‡∏î‡∏¢‡∏°‡∏µ -p[password] ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏≠‡∏á‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏î‡∏π‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ Password ‡∏ô‡∏µ‡πâ

 ![‡∏•‡∏≠‡∏á‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ Password ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå](/images/malware-diary2/16.png)

‡∏•‡∏≠‡∏á‡∏î‡∏π‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏†‡∏≤‡∏û‡∏ö‡∏ô‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤ ‡∏°‡∏±‡∏ô‡∏°‡∏µ‡∏ö‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏ô‡∏±‡πà‡∏ô‡∏Ñ‡∏∑‡∏≠‡πÑ‡∏ü‡∏•‡πå app.exe ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏ü‡∏•‡πå app.exe ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏´‡∏ô?

‡πÄ‡∏•‡∏¢‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏™‡πà‡∏≠‡∏á String ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‚Ä¶

  ![‡∏Ç‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡∏¢‡∏à‡∏Ñ‡∏¥‡∏î‡πÅ‡∏Ñ‡∏õ‡∏ä‡∏±‡πà‡∏ô](/images/malware-diary2/11.png)

‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏°‡∏±‡∏ô‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á Copy ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏Æ‡∏∞‚Ä¶‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ï‡πà‡∏≠‡∏°‡∏≤‡∏Å‡πá‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏´‡∏ô? ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏∑‡∏≠ Copy ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå Execute ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏£‡∏±‡∏ô‡πÑ‡∏õ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏ô‡∏±‡πà‡∏ô‡πÅ‡∏´‡∏•‡∏∞(‡πÄ‡∏≠‡∏≤ hash ‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏î‡∏π) ‡πÅ‡∏ï‡πà‡∏°‡∏±‡∏ô Copy ‡∏°‡∏≤‡∏ó‡∏≥‡πÑ‡∏°‡∏ü‡∏∞‡∏∞‡∏∞? ‡πÄ‡∏•‡∏¢‡∏ß‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏î‡∏π‡∏ó‡∏µ‡πà String ‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‚Ä¶‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏á

‡∏°‡∏±‡∏ô‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ Registry ‡πÅ‡∏Æ‡∏∞ ‡πÑ‡∏õ‡πÄ‡∏ä‡πá‡∏î Log ‡∏î‡πâ‡∏ß‡∏¢‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ä‡∏±‡∏ß‡∏£‡πå ‡πÜ

![1559501244370](/images/malware-diary2/9-1.png)

‡∏ã‡∏∂‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏ú‡∏°‡∏™‡∏£‡∏∏‡∏õ‡∏°‡∏≤‡πÑ‡∏î‡πâ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡∏ö

| ‡∏Ñ‡πà‡∏≤ Registry ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á                                   | ‡∏Ñ‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô        | ‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô               |
| ------------------------------------------------------------ | ----------------- | ------------------------ |
| HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Associations\LowRiskFileTypes | ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤     | .exe                     |
| HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Associations\LowRiskFileTypes | ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤     | .exe                     |
| HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\EnableLUA | ‡πÇ‡∏î‡∏¢‡∏õ‡∏Å‡∏ï‡∏¥‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô 1 | 0                        |
| HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run\Google Updater | ‡πÑ‡∏°‡πà‡∏°‡∏µ Registry ‡∏ô‡∏µ‡πâ    | %appdata%/(user)/app.exe |
| HKCU\Software\Unzip\Installed                                | ‡πÑ‡∏°‡πà‡∏°‡∏µ Registry ‡∏ô‡∏µ‡πâ    | Yes                      |

1. Registry ‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏Å‡∏∏‡∏•‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô ‡πÇ‡∏î‡∏¢‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏ï‡∏±‡∏ß‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• .exe ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°[‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡∏ô‡∏µ‡πâ](https://blog.malwarebytes.com/detections/pum-optional-lowriskfiletypes/)‡πÄ‡∏ö‡∏¢
2. ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏´‡∏ô‡∏∂‡πà‡∏á ‡∏•‡∏≠‡∏á‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏ï‡∏£‡∏á‡πÑ‡∏´‡∏ô‡πÅ‡∏•‡∏∞‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏™‡πà‡∏á‡∏ú‡∏•‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£
3. Registry ‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô 0 (False) ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡∏ï‡πÄ‡∏≠‡∏£‡πå [‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°](https://docs.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/microsoft-windows-lua-settings-enablelua)
4. **‡∏Ç‡πâ‡∏≠‡∏ô‡∏µ‡πâ‡∏î‡∏π‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Æ‡∏∞** ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤ Value ‡∏î‡πâ‡∏≤‡∏ô‡πÉ‡∏ô‡∏°‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô Path ‡∏ó‡∏µ‡πà‡πÑ‡∏õ‡∏ó‡∏µ‡πà %appdata%/(user)/app.exe  ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Registry ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ Windows ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ù‡∏±‡∏á‡∏ï‡∏±‡∏ß‡∏ö‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á..
5. ‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡πÑ‡∏°‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡πÅ‡∏ô‡πà‡πÉ‡∏à‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£ ‡πÄ‡∏û‡∏£‡∏≤‡∏•‡∏≠‡∏á‡πÑ‡∏•‡πà‡∏î‡∏π Flow ‡∏°‡∏±‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πà‡∏≤ Registry ‡∏ô‡∏µ‡πâ‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå 7za.exe ‡πÄ‡∏™‡∏£‡πá‡∏à ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ‡∏≠‡∏∞‡πÑ‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ô‡∏µ‡πâ

 ‡πÅ‡∏ï‡πà‚Ä¶‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏£‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ã‡πâ‡∏≥‡πÑ‡∏õ‡∏ó‡∏≥‡πÑ‡∏°‡∏ß‡∏∞ 555    ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏£‡∏≤‡πÄ‡∏´‡πá‡∏ô‡πÅ‡∏Ñ‡πà Mechanism ‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ù‡∏±‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏Ñ‡πà‡∏≠‡∏¢‡πÄ‡∏´‡πá‡∏ô Mechanism ‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏°‡∏±‡∏ô‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡πÄ‡∏•‡∏¢

‡∏à‡∏£‡∏¥‡∏á ‡πÜ ProcMon ‡∏°‡∏µ‡∏≠‡∏µ‡∏Å Feature ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡∏Ñ‡∏∑‡∏≠ Process Tree

![app.exe ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å update-x64.exe ‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏Æ‡∏∞](/images/malware-diary2/11-1.png)

‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤ Process ‡πÑ‡∏´‡∏ô‡∏°‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Process ‡πÑ‡∏´‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏à‡∏≤‡∏Å Process Tree ‡πÄ‡∏ô‡∏µ‡πà‡∏¢ ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤ app.exe ‡∏°‡∏±‡∏ô‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ó‡∏±‡πâ‡∏á chrome.exe(Google Chrome) ‡πÅ‡∏•‡∏∞ update-x64.exe(Monero Miner) 

‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á Google Chrome ‡πÄ‡∏ô‡∏µ‡πà‡∏¢‡∏ú‡∏°‡∏Ç‡∏≠‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞ ‡πÄ‡∏î‡∏µ‡πâ‡∏¢‡∏ß‡πÄ‡∏£‡∏≤‡∏°‡∏≤‡∏î‡∏π‡∏Å‡∏±‡∏ô Part ‡∏´‡∏ô‡πâ‡∏≤ ‡∏ã‡∏∂‡πà‡∏á‡∏ú‡∏°‡∏ß‡πà‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡πÑ‡∏°‡πà‡πÅ‡∏û‡πâ‡∏Å‡∏±‡∏ô

![](/images/malware-diary2/12.png)

‡∏à‡∏≤‡∏Å‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡πá‡∏Ñ CPU Architecture ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Mining ‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç Monero ‡∏î‡πâ‡∏ß‡∏¢

‡∏ã‡∏∂‡πà‡∏á‡∏ô‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏°‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Registry ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠ StartUp ‡πÑ‡∏õ‡∏ó‡∏µ‡πà %appdata%/[user]/app.exe(‡∏ï‡∏±‡∏ß‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡πÄ‡∏≠‡∏á) ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏±‡∏ß‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏à‡∏∂‡∏á‡∏°‡∏≤‡∏£‡∏±‡∏ô Update-x64.exe ‡∏ï‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Mining Monero ‡∏ï‡πà‡∏≠
‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå Config ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô Path ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á

**‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ç‡∏µ‡πâ‡πÄ‡∏Å‡∏µ‡∏¢‡∏à‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö** Part ‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡∏Ç‡∏≠‡πÄ‡∏ö‡∏£‡∏Ñ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏î‡∏µ‡πâ‡∏¢‡∏ß Part ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏°‡∏≤‡∏î‡∏π‡∏Å‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏•‡πÅ‡∏ß‡∏£‡πå‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡∏°‡∏±‡∏ô‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡∏±‡∏ö Google Chrome ‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏¢‡∏∑‡πà‡∏≠‡∏ö‡πâ‡∏≤‡∏á ‡∏ú‡∏°‡∏ß‡πà‡∏≤‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏™‡∏ô‡∏∏‡∏Å‡πÑ‡∏°‡πà‡πÅ‡∏û‡πâ Part ‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö

‡∏ñ‡πâ‡∏≤‡∏≠‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏ñ‡∏∂‡∏á‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏à‡∏ô‡∏ñ‡∏∂‡∏á Part 2 ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏ô‡∏à‡∏ö‡∏≠‡∏µ‡∏Å ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î/‡∏≠‡∏¢‡∏≤‡∏Å‡∏ï‡∏¥‡∏ä‡∏°‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏°‡∏ô‡∏ä‡∏±‡πà‡∏ô‡∏°‡∏≤‡∏ö‡∏≠‡∏Å‡∏ú‡∏°‡πÉ‡∏ô Twitter ‡πÄ‡∏•‡∏¢‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ï‡∏¥‡∏ä‡∏°‡πÑ‡∏õ‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏™‡∏°‡∏≠‡∏Ñ‡∏£‡∏±‡∏ö üòÑ

‡∏õ‡∏•. ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©‡∏à‡∏£‡∏¥‡∏á ‡πÜ ‡∏Ñ‡∏£‡∏±‡∏ö‡∏ó‡∏µ‡πà Part ‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡∏ä‡πâ‡∏≤‡∏°‡∏≤‡∏Å  ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ï‡∏¥‡∏î‡∏Ñ‡πà‡∏≤‡∏¢ [ITCAMP | KMITL](https://www.facebook.com/itcampKMITL/)  ‡πÑ‡∏î‡πâ‡∏Ç‡πà‡∏≤‡∏ß‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏¢ Netherine ‡∏°‡∏µ‡πÄ‡∏•‡πà‡∏ô CTF ‡∏Å‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢ ‡πÑ‡∏°‡πà‡πÑ‡∏õ‡∏Å‡πá‡∏Å‡∏•‡∏±‡∏ß‡∏à‡∏∞‡πÄ‡∏™‡∏µ‡∏¢‡∏î‡∏≤‡∏¢‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ß‡πä‡∏õ‡πÑ‡∏õ‡∏´‡∏ô‡πà‡∏≠‡∏¢ üòÖ

